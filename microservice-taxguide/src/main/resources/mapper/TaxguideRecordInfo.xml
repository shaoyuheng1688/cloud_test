<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.raymon.taxguide.mapper.TaxguideRecordInfoMapper">
    <select id="getTaxGuideRecordInfosByBussId" parameterType="java.lang.String" resultType="com.raymon.taxguide.model.TaxguideRecordInfo">
		SELECT
			B.TG_INFO_ID,
		    B.STATE,
		    B.CREATE_TIME,
		    B.CALL_TIME,
		    B.START_TIME,
		    (CASE WHEN B.STATE = 5 THEN A.END_TIME ELSE B.FINISH_TIME END ) FINISH_TIME,
		    B.REMARK,
            ACC.ACC_CODE accCode,
		    ACC.EMP_NUMBER empNumber
		FROM
		   T_TAXGUIDE_RECORD A
		   LEFT JOIN T_TAXGUIDE_RECORD_INFO B ON A.TG_ID = B.TG_ID
		   LEFT JOIN T_ACCOUNT ACC ON B.ACC_ID = ACC.ACC_ID
		   LEFT JOIN T_NOTE D ON 1=1
        WHERE
		   A.BUSSID = #{bussId}
		AND ROWNUM &lt; 500000
    </select>
</mapper>